<!-- Trang Qu·∫£n l√Ω Nh√¢n vi√™n (gi·ªëng trang Nh√† s·∫£n xu·∫•t) -->
<div class="employees-container">
  <!-- Header with Navigation -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="logo-section">
        <h1 class="logo">FeDoan</h1>
        <button class="mobile-menu-toggle" (click)="toggleMobileMenu()">
          <i class="fas fa-bars"></i>
        </button>
        <nav class="main-nav" [class.mobile-open]="isMobileMenuOpen">
          <a href="#" class="nav-link" (click)="navigateToDashboard(); $event.preventDefault()">Trang ch·ªß</a>
          <a href="#" class="nav-link" (click)="navigateToProducts(); $event.preventDefault()">H√†ng h√≥a</a>
          <a class="nav-link" routerLink="/pos">B√°n h√†ng</a>
          <a href="#" class="nav-link" (click)="navigateToCustomers(); $event.preventDefault()">Kh√°ch h√†ng</a>
          <a href="#" class="nav-link active" (click)="navigateToEmployees(); $event.preventDefault()">Nh√¢n vi√™n</a>
          <a href="#" class="nav-link" (click)="navigateToReports(); $event.preventDefault()">B√°o c√°o</a>
          <a href="#" class="nav-link" (click)="navigateToManufacturers(); $event.preventDefault()">Nh√† s·∫£n xu·∫•t</a>
          <a href="#" class="nav-link" (click)="navigateToInvoices(); $event.preventDefault()">H√≥a ƒë∆°n</a>
          <li>
            <a (click)="navigateToPromotions()" class="nav-link">
              <span class="icon">üéÅ</span>
              <span>Khuy·∫øn m√£i</span>
            </a>
          </li>
        </nav>
      </div>
      <div class="user-section">
        <button class="theme-toggle" (click)="changeTheme()" title="ƒê·ªïi theme">
          <i class="fas fa-palette"></i>
          <span>{{ getCurrentThemeLabel() }}</span>
        </button>
        
        <app-notification-bell></app-notification-bell>
        
        <div class="user-profile">
          <img [src]="currentUser.avatar" [alt]="currentUser.name" class="user-avatar">
          <div class="user-info">
            <span class="user-name">{{ currentUser.name }}</span>
            <button class="logout-btn" (click)="logout()" title="ƒêƒÉng xu·∫•t">
              <i class="fas fa-sign-out-alt"></i>
              <span>ƒêƒÉng xu·∫•t</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="page-content">
    <div class="content-layout">
      <!-- Mobile Filter Toggle Button -->
      <button class="mobile-filter-toggle" (click)="toggleFilters()" *ngIf="!showFilters">
        <i class="fas fa-filter"></i>
        <span>B·ªô l·ªçc</span>
        <span class="filter-count" *ngIf="hasActiveFilters()">{{ getActiveFilterCount() }}</span>
      </button>

      <!-- Left Sidebar - Filters -->
      <aside class="filters-sidebar" [class.mobile-show]="showFilters">
        <div class="filters-header">
          <h3><i class="fas fa-filter"></i> B·ªô l·ªçc</h3>
          <div class="filters-header-actions">
            <button class="btn-reset-filter" (click)="resetFilters()" title="X√≥a b·ªô l·ªçc">
              <i class="fas fa-redo"></i>
            </button>
            <button class="btn-close-filter" (click)="toggleFilters()" title="ƒê√≥ng">
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>
        <div class="filters-content">
          <!-- T√¨m ki·∫øm -->
          <div class="filter-group">
            <label><i class="fas fa-search"></i> T√¨m ki·∫øm</label>
            <input type="text"
                   class="filter-input"
                   [(ngModel)]="filters.searchText"
                   (input)="applyFilter()"
                   placeholder="T√™n, m√£, SƒêT, email...">
          </div>
          <!-- Ch·ª©c v·ª• -->
          <div class="filter-group">
            <label><i class="fas fa-user-tie"></i> Ch·ª©c v·ª•</label>
            <input type="text"
                   class="filter-input"
                   [(ngModel)]="filters.position"
                   (input)="applyFilter()"
                   placeholder="Qu·∫£n l√Ω, b√°n h√†ng...">
          </div>
          <!-- Tr·∫°ng th√°i -->
          <div class="filter-group">
            <label><i class="fas fa-toggle-on"></i> Tr·∫°ng th√°i</label>
            <select class="filter-select"
                    [(ngModel)]="filters.workStatus"
                    (change)="applyFilter()">
              <option value="">T·∫•t c·∫£</option>
              <option value="active">Ho·∫°t ƒë·ªông</option>
              <option value="inactive">Ng·ª´ng ho·∫°t ƒë·ªông</option>
              <option value="probation">Th·ª≠ vi·ªác</option>
            </select>
          </div>
          <!-- S·∫Øp x·∫øp -->
          <div class="filter-group">
            <label><i class="fas fa-sort"></i> S·∫Øp x·∫øp theo</label>
            <select class="filter-select"
                    [(ngModel)]="filters.sortBy"
                    (change)="applyFilter()">
              <option value="name-asc">T√™n A-Z</option>
              <option value="name-desc">T√™n Z-A</option>
              <option value="recent">M·ªõi nh·∫•t</option>
            </select>
          </div>
        </div>
        <!-- Filter Summary -->
        <div class="filter-summary">
          <p><strong>{{ filteredEmployees.length }}</strong> nh√¢n vi√™n</p>
        </div>
      </aside>

      <!-- Overlay for mobile filters -->
      <div class="filters-overlay"
           [class.active]="showFilters"
           (click)="toggleFilters()"></div>

      <!-- Right Content Area -->
      <div class="content-area">
        <div class="content-header">
          <h2>Qu·∫£n l√Ω Nh√¢n vi√™n</h2>
          <button class="btn-add-new" (click)="openAddDialog()" [disabled]="isLoading">
            <i class="fas fa-plus"></i>
            <span>Th√™m nh√¢n vi√™n</span>
          </button>
        </div>
        <!-- Loading Spinner -->
        <div class="loading-container" *ngIf="isLoading">
          <i class="fas fa-spinner fa-spin"></i>
          <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
        </div>
        <!-- Error Message -->
        <div class="error-message" *ngIf="errorMessage && !isLoading">
          <i class="fas fa-exclamation-circle"></i>
          <span>{{ errorMessage }}</span>
        </div>
        <!-- Employees Table -->
        <div class="table-container" *ngIf="!isLoading">
          <table class="data-table">
            <thead>
              <tr>
                <th>M√£ NV</th>
                <th>T√™n nh√¢n vi√™n</th>
                <th>ƒêi·ªán tho·∫°i</th>
                <th>Email</th>
                <th>Ph√≤ng ban</th>
                <th>Ch·ª©c v·ª•</th>
                <th>Ng√†y v√†o l√†m</th>
                <th>L∆∞∆°ng</th>
                <th>Tr·∫°ng th√°i l√†m vi·ªác</th>
                <th>Thao t√°c</th>
              </tr>
            </thead>
            <tbody>
              <ng-container *ngIf="filteredEmployees && filteredEmployees.length > 0; else noData">
                <tr *ngFor="let employee of filteredEmployees; trackBy: trackByEmployeeId">
                  <td><strong>{{ employee.employeeCode }}</strong></td>
                  <td>{{ employee.employeeName }}</td>
                  <td>{{ employee.phone }}</td>
                  <td>{{ employee.email || 'N/A' }}</td>
                  <td>{{ employee.department || 'N/A' }}</td>
                  <td>{{ employee.position || 'N/A' }}</td>
                  <td>{{ employee.hireDate ? (employee.hireDate | date:'dd/MM/yyyy') : 'N/A' }}</td>
                  <td>{{ employee.salary | number:'1.0-0' }}</td>
                  <td>
                    <span class="status-badge" [ngClass]="employee.workStatus">
                      {{ employee.workStatus || 'N/A' }}
                    </span>
                  </td>
                  <td>
                    <div class="action-buttons">
                      <button class="btn-action btn-edit" (click)="editEmployee(employee)" title="Ch·ªânh s·ª≠a" [disabled]="isLoading">
                        <i class="fas fa-edit"></i>
                      </button>
                      <button class="btn-action btn-delete" (click)="deleteEmployee(employee)" title="X√≥a" [disabled]="isLoading">
                        <i class="fas fa-trash"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              </ng-container>
              <ng-template #noData>
                <tr>
                  <td colspan="10" class="no-data">
                    <i class="fas fa-users"></i>
                    <p>{{ filters.searchText ? 'Kh√¥ng t√¨m th·∫•y nh√¢n vi√™n ph√π h·ª£p' : 'Ch∆∞a c√≥ d·ªØ li·ªáu nh√¢n vi√™n' }}</p>
                  </td>
                </tr>
              </ng-template>
            </tbody>
          </table>
        </div>
        <!-- Add/Edit Employee Dialog -->
        <div class="dialog-overlay" [class.active]="showDialog" (click)="closeDialog()">
          <div class="dialog-container" (click)="$event.stopPropagation()">
            <div class="dialog-header">
              <h3>{{ isEditMode ? 'Ch·ªânh s·ª≠a nh√¢n vi√™n' : 'Th√™m nh√¢n vi√™n m·ªõi' }}</h3>
              <button class="btn-close" (click)="closeDialog()">
                <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="dialog-error" *ngIf="errorMessage">
              <i class="fas fa-exclamation-triangle"></i>
              <span>{{ errorMessage }}</span>
            </div>
            <form class="dialog-form" (ngSubmit)="saveEmployee()">
              <div class="form-grid">
                <div class="form-group">
                  <label for="employeeCode">M√£ nh√¢n vi√™n <span class="required">*</span></label>
                  <input type="text" id="employeeCode" [(ngModel)]="currentEmployee.employeeCode"
                         name="employeeCode" placeholder="VD: a1b2c3d4" required readonly maxlength="8">
                  <small class="form-hint">M√£ s·∫Ω ƒë∆∞·ª£c t·∫°o t·ª± ƒë·ªông (8 k√Ω t·ª±)</small>
                </div>
                <div class="form-group full-width">
                  <label for="employeeName">T√™n nh√¢n vi√™n <span class="required">*</span></label>
                  <input type="text" id="employeeName" [(ngModel)]="currentEmployee.employeeName"
                         name="employeeName" placeholder="VD: Nguy·ªÖn VƒÉn B" required>
                </div>
                <div class="form-group">
                  <label for="phone">S·ªë ƒëi·ªán tho·∫°i <span class="required">*</span></label>
                  <input type="tel" id="phone" [(ngModel)]="currentEmployee.phone"
                         name="phone" placeholder="VD: 0123456789" required>
                </div>
                <div class="form-group">
                  <label for="email">Email</label>
                  <input type="email" id="email" [(ngModel)]="currentEmployee.email"
                         name="email" placeholder="VD: employee@example.com">
                </div>
                <div class="form-group">
                  <label for="position">Ch·ª©c v·ª•</label>
                  <input type="text" id="position" [(ngModel)]="currentEmployee.position"
                         name="position" placeholder="VD: Qu·∫£n l√Ω, Nh√¢n vi√™n b√°n h√†ng">
                </div>
                <div class="form-group">
                  <label for="workStatus">Tr·∫°ng th√°i l√†m vi·ªác</label>
                  <select id="workStatus" [(ngModel)]="currentEmployee.workStatus" name="workStatus">
                    <option value="">Ch·ªçn</option>
                    <option value="active">Ho·∫°t ƒë·ªông</option>
                    <option value="inactive">Ng·ª´ng ho·∫°t ƒë·ªông</option>
                    <option value="probation">Th·ª≠ vi·ªác</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="address">ƒê·ªãa ch·ªâ</label>
                  <input type="text" id="address" [(ngModel)]="currentEmployee.address" name="address" placeholder="ƒê·ªãa ch·ªâ">
                </div>
                <div class="form-group">
                  <label for="dateOfBirth">Ng√†y sinh</label>
                  <input type="date" id="dateOfBirth" [(ngModel)]="currentEmployee.dateOfBirth" name="dateOfBirth">
                </div>
                <div class="form-group">
                  <label for="gender">Gi·ªõi t√≠nh</label>
                  <select id="gender" [(ngModel)]="currentEmployee.gender" name="gender">
                    <option value="">Ch·ªçn</option>
                    <option value="male">Nam</option>
                    <option value="female">N·ªØ</option>
                    <option value="other">Kh√°c</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="idCard">CMND/CCCD</label>
                  <input type="text" id="idCard" [(ngModel)]="currentEmployee.idCard" name="idCard" placeholder="CMND/CCCD">
                </div>
                <div class="form-group">
                  <label for="department">Ph√≤ng ban</label>
                  <input type="text" id="department" [(ngModel)]="currentEmployee.department" name="department" placeholder="Ph√≤ng ban">
                </div>
                <div class="form-group">
                  <label for="hireDate">Ng√†y v√†o l√†m</label>
                  <input type="date" id="hireDate" [(ngModel)]="currentEmployee.hireDate" name="hireDate">
                </div>
                <div class="form-group">
                  <label for="salary">L∆∞∆°ng</label>
                  <input type="number" id="salary" [(ngModel)]="currentEmployee.salary" name="salary" placeholder="0" min="0">
                </div>
                <div class="form-group">
                  <label for="salaryType">Lo·∫°i l∆∞∆°ng</label>
                  <input type="text" id="salaryType" [(ngModel)]="currentEmployee.salaryType" name="salaryType" placeholder="Lo·∫°i l∆∞∆°ng">
                </div>
                <div class="form-group">
                  <label for="bankAccount">S·ªë t√†i kho·∫£n</label>
                  <input type="text" id="bankAccount" [(ngModel)]="currentEmployee.bankAccount" name="bankAccount" placeholder="S·ªë t√†i kho·∫£n">
                </div>
                <div class="form-group">
                  <label for="bankName">T√™n ng√¢n h√†ng</label>
                  <input type="text" id="bankName" [(ngModel)]="currentEmployee.bankName" name="bankName" placeholder="T√™n ng√¢n h√†ng">
                </div>
                <div class="form-group">
                  <label for="username">T√™n ƒëƒÉng nh·∫≠p</label>
                  <input type="text" id="username" [(ngModel)]="currentEmployee.username" name="username" placeholder="T√™n ƒëƒÉng nh·∫≠p">
                </div>
                <div class="form-group">
                  <label for="password">M·∫≠t kh·∫©u</label>
                  <input type="password" id="password" [(ngModel)]="currentEmployee.password" name="password" placeholder="M·∫≠t kh·∫©u">
                </div>
                <div class="form-group">
                  <label for="permissions">Quy·ªÅn</label>
                  <input type="text" id="permissions" [(ngModel)]="currentEmployee.permissions" name="permissions" placeholder="Quy·ªÅn">
                </div>
                <div class="form-group">
                  <label for="avatarUrl">Avatar</label>
                  <input type="text" id="avatarUrl" [(ngModel)]="currentEmployee.avatarUrl" name="avatarUrl" placeholder="URL ·∫£nh ƒë·∫°i di·ªán">
                </div>
                <div class="form-group">
                  <label for="workStatus">Tr·∫°ng th√°i l√†m vi·ªác</label>
                  <select id="workStatus" [(ngModel)]="currentEmployee.workStatus" name="workStatus">
                    <option value="">Ch·ªçn</option>
                    <option value="active">Ho·∫°t ƒë·ªông</option>
                    <option value="inactive">Ng·ª´ng ho·∫°t ƒë·ªông</option>
                    <option value="probation">Th·ª≠ vi·ªác</option>
                  </select>
                </div>
                <div class="form-group full-width">
                  <label for="notes">Ghi ch√∫</label>
                  <textarea id="notes" [(ngModel)]="currentEmployee.notes"
                            name="notes" rows="3" placeholder="Ghi ch√∫ th√™m v·ªÅ nh√¢n vi√™n..."></textarea>
                </div>
              </div>
              <div class="dialog-footer">
                <button type="button" class="btn-cancel" (click)="closeDialog()" [disabled]="isLoading">
                  <i class="fas fa-times"></i>
                  H·ªßy
                </button>
                <button type="submit" class="btn-save" [disabled]="isLoading">
                  <i class="fas" [ngClass]="isLoading ? 'fa-spinner fa-spin' : 'fa-save'"></i>
                  {{ isLoading ? 'ƒêang l∆∞u...' : (isEditMode ? 'C·∫≠p nh·∫≠t' : 'Th√™m m·ªõi') }}
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
